<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zoomable Image</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            overflow: hidden; /* Prevent body scroll if image overflows */
        }

        #image-container {
            width: 80%; /* Adjust as needed */
            height: 80vh; /* Adjust as needed */
            display:block;
            justify-content: center;
            align-items: center;
            border: 2px solid #ccc;
            overflow: hidden; /* Crucial for containing the image within bounds */
            position: relative; /* For potential future positioning of controls */
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        #zoom-and-pan-container {
            display: block;
            max-width: 100%;
            max-height: 100%;
            transform-origin: center center; /* Zoom from the center */
            transition: transform 0.05s ease-out; /* Smooth transition for zoom */
            cursor: grab; /* Indicate it's draggable */
            user-select: none; /* Prevent text selection on the image */
            justify-content: center;
            overflow: hidden;
        }

        #zoom-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain; /* Ensures the whole image is visible initially */
            transform-origin: center center; /* Zoom from the center */
            transition: transform 0.05s ease-out; /* Smooth transition for zoom */
            cursor: grab; /* Indicate it's draggable */
            user-select: none; /* Prevent text selection on the image */
        }
    </style>
</head>
<body>

    <div id="image-container">
        <div id="zoom-and-pan-container">
            <img id="zoom-image" src="https://hopon.no/wp-content/uploads/2024/03/hop-on-hop-off-sightseeing-tour-bus-aalesund-attractions-aksla-byrampen.webp" alt="Zoomable Image">
        </div>
    </div>

    <script>
        const zoomImage = document.getElementById('zoom-image');
        const zoomPanContainer = document.getElementById('zoom-and-pan-container');
        const imageContainer = document.getElementById('image-container');

        let scale = 1;
        const scaleStep = 0.1; // How much to zoom in/out each step
        let isDragging = false;
        let startX, startY;
        let currentX = 0, currentY = 0; // Current translation values

        imageContainer.addEventListener('wheel', (e) => {
            if (e.ctrlKey) {
                if (e.deltaY < 0) {
                    // Zoom in
                    scale += scaleStep;
                } else {
                    // Zoom out
                    scale = Math.max(0.2, scale - scaleStep); // Prevent zooming out too much
                }
                updateImageTransform(e);
            }
        });

        function updateImageTransform(e) {
            zoomImage.style.transform = `scale(${scale}) translate(${currentX}px, ${currentY}px)`;
        }

        // Drag functionality
        zoomImage.addEventListener('mousedown', (e) => {
            if (scale > 1) { // Only allow dragging if zoomed in
                isDragging = true;
                startX = e.clientX - currentX;
                startY = e.clientY - currentY;
                zoomImage.style.cursor = 'grabbing';
            }
        });

        imageContainer.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            e.preventDefault();
            currentX = e.clientX - startX;
            currentY = e.clientY - startY;
            updateImageTransform(e);
        });

        imageContainer.addEventListener('mouseup', () => {
            isDragging = false;
            zoomImage.style.cursor = 'grab';
        });

        imageContainer.addEventListener('mouseleave', () => {
            isDragging = false;
            zoomImage.style.cursor = 'grab';
        });
        function showDisplayRect() {
            const imageContRect = imageContainer.getBoundingClientRect();
            const zoomContRect = zoomPanContainer.getBoundingClientRect();
            const imageRect = zoomImage.getBoundingClientRect();
            
            console.log(`imageContRect: x:${imageContRect.x} y:${imageContRect.y} height:${imageContRect.height} width:${imageContRect.width}`);
            console.log(`zoomContRect: x:${zoomContRect.x} y:${zoomContRect.y} height:${zoomContRect.height} width:${zoomContRect.width}`);
            console.log(`imageRect: x:${imageRect.x} y:${imageRect.y} height:${imageRect.height} width:${imageRect.width}`);
            
        }

        setInterval(() => {
            showDisplayRect();
        }, 100);
    </script>

</body>
</html>